<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Franz√∂sisch ‚Äì Pass√© Compos√© Trainer</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    background:#f7f8fc;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    color:#222;
  }
  h1 {color:#3366cc;}
  #card {
    background:white;
    padding:2rem;
    border-radius:1rem;
    box-shadow:0 0.5rem 1rem rgba(0,0,0,0.1);
    text-align:center;
    max-width:500px;
  }
  .mode-selector {
    display:flex;
    gap:1rem;
    margin-bottom:1.5rem;
  }
  .mode-btn {
    flex:1;
    padding:0.75rem;
    border:2px solid #3366cc;
    background:white;
    color:#3366cc;
    cursor:pointer;
    border-radius:0.5rem;
    font-weight:bold;
    transition:all 0.3s;
  }
  .mode-btn.active {
    background:#3366cc;
    color:white;
  }
  .mode-btn:hover {
    transform:translateY(-2px);
  }
  input, select, button {
    font-size:1rem;
    padding:0.5rem;
    margin-top:1rem;
    width:100%;
    border-radius:0.5rem;
    border:1px solid #ccc;
  }
  .hidden {
    display:none;
  }
  #result { margin-top:1rem; font-weight:bold; }
  #correct {color:green;}
  #wrong {color:red;}
  #feedback {
    margin-top:1rem;
    padding:1rem;
    background:#fff3cd;
    border-left:4px solid #ffc107;
    border-radius:0.5rem;
    text-align:left;
    font-size:0.9rem;
  }
  #feedback ul {
    margin:0.5rem 0;
    padding-left:1.5rem;
  }
  .next-btn {
    background:#28a745;
    color:white;
    border:none;
    cursor:pointer;
    margin-top:0.5rem;
  }
  .next-btn:hover {
    background:#218838;
  }
</style>
</head>
<body>
  <h1>Pass√© Compos√© √ºben üá´üá∑</h1>
  <div id="card">
    <div class="mode-selector">
      <button class="mode-btn active" data-mode="1">Modus 1: Verb</button>
      <button class="mode-btn" data-mode="2">Modus 2: Satz</button>
    </div>
    
    <div id="question"></div>
    
    <!-- Modus 1: Verb mit Personalform -->
    <div id="mode1-inputs">
      <input id="answer" type="text" placeholder="z. B. je suis all√©(e)">
    </div>
    
    <!-- Modus 2: Ganzer Satz -->
    <div id="mode2-inputs" class="hidden">
      <input id="sentence-answer" type="text" placeholder="Ganzen Satz auf Franz√∂sisch eingeben">
    </div>
    
    <button id="check">√úberpr√ºfen</button>
    <div id="result"></div>
    <div id="feedback" class="hidden"></div>
  </div>

<script>
const verbs = [
  // √™tre-Verben
  {inf:"aller", aux:"√™tre", pc:"je suis all√©(e)", de:"Ich bin ins Kino gegangen.", fr:"Je suis all√©(e) au cin√©ma."},
  {inf:"venir", aux:"√™tre", pc:"je suis venu(e)", de:"Ich bin zu dir gekommen.", fr:"Je suis venu(e) chez toi."},
  {inf:"arriver", aux:"√™tre", pc:"je suis arriv√©(e)", de:"Ich bin in der Schule angekommen.", fr:"Je suis arriv√©(e) √† l'√©cole."},
  {inf:"partir", aux:"√™tre", pc:"je suis parti(e)", de:"Ich bin in die Ferien gefahren.", fr:"Je suis parti(e) en vacances."},
  {inf:"entrer", aux:"√™tre", pc:"je suis entr√©(e)", de:"Ich bin ins Haus eingetreten.", fr:"Je suis entr√©(e) dans la maison."},
  {inf:"sortir", aux:"√™tre", pc:"je suis sorti(e)", de:"Ich bin mit meinen Freunden ausgegangen.", fr:"Je suis sorti(e) avec mes amis."},
  {inf:"na√Ætre", aux:"√™tre", pc:"je suis n√©(e)", de:"Ich bin in der Schweiz geboren.", fr:"Je suis n√©(e) en Suisse."},
  {inf:"mourir", aux:"√™tre", pc:"je suis mort(e)", de:"Ich bin vor Lachen gestorben.", fr:"Je suis mort(e) de rire."},
  {inf:"tomber", aux:"√™tre", pc:"je suis tomb√©(e)", de:"Ich bin auf den Boden gefallen.", fr:"Je suis tomb√©(e) par terre."},
  {inf:"rester", aux:"√™tre", pc:"je suis rest√©(e)", de:"Ich bin zu Hause geblieben.", fr:"Je suis rest√©(e) √† la maison."},
  // avoir-Verben (unregelm√§ssige + -er)
  {inf:"avoir", aux:"avoir", pc:"j'ai eu", de:"Ich habe eine gute Note gehabt.", fr:"J'ai eu une bonne note."},
  {inf:"√™tre", aux:"avoir", pc:"j'ai √©t√©", de:"Ich bin gestern krank gewesen.", fr:"J'ai √©t√© malade hier."},
  {inf:"faire", aux:"avoir", pc:"j'ai fait", de:"Ich habe meine Hausaufgaben gemacht.", fr:"J'ai fait mes devoirs."},
  {inf:"pouvoir", aux:"avoir", pc:"j'ai pu", de:"Ich habe zur Party kommen k√∂nnen.", fr:"J'ai pu venir √† la f√™te."},
  {inf:"vouloir", aux:"avoir", pc:"j'ai voulu", de:"Ich habe fr√ºh weggehen wollen.", fr:"J'ai voulu partir t√¥t."},
  {inf:"savoir", aux:"avoir", pc:"j'ai su", de:"Ich habe die Antwort gewusst.", fr:"J'ai su la r√©ponse."},
  {inf:"voir", aux:"avoir", pc:"j'ai vu", de:"Ich habe gestern einen Film gesehen.", fr:"J'ai vu un film hier."},
  {inf:"mettre", aux:"avoir", pc:"j'ai mis", de:"Ich habe meinen Mantel angezogen.", fr:"J'ai mis mon manteau."},
  {inf:"prendre", aux:"avoir", pc:"j'ai pris", de:"Ich habe den Bus genommen.", fr:"J'ai pris le bus."},
  {inf:"dire", aux:"avoir", pc:"j'ai dit", de:"Ich habe die Wahrheit gesagt.", fr:"J'ai dit la v√©rit√©."},
  {inf:"finir", aux:"avoir", pc:"j'ai fini", de:"Ich habe meine Arbeit beendet.", fr:"J'ai fini mon travail."},
  {inf:"trouver", aux:"avoir", pc:"j'ai trouv√©", de:"Ich habe meine Schl√ºssel gefunden.", fr:"J'ai trouv√© mes cl√©s."},
  {inf:"√©couter", aux:"avoir", pc:"j'ai √©cout√©", de:"Ich habe Musik geh√∂rt.", fr:"J'ai √©cout√© de la musique."},
  {inf:"jouer", aux:"avoir", pc:"j'ai jou√©", de:"Ich habe Fu√üball gespielt.", fr:"J'ai jou√© au football."},
  {inf:"regarder", aux:"avoir", pc:"j'ai regard√©", de:"Ich habe ferngesehen.", fr:"J'ai regard√© la t√©l√©."},
  {inf:"parler", aux:"avoir", pc:"j'ai parl√©", de:"Ich habe mit Marie gesprochen.", fr:"J'ai parl√© avec Marie."},
  {inf:"aimer", aux:"avoir", pc:"j'ai aim√©", de:"Ich habe dieses Buch gemocht.", fr:"J'ai aim√© ce livre."},
  {inf:"chercher", aux:"avoir", pc:"j'ai cherch√©", de:"Ich habe mein Handy gesucht.", fr:"J'ai cherch√© mon portable."},
  {inf:"manger", aux:"avoir", pc:"j'ai mang√©", de:"Ich habe eine Pizza gegessen.", fr:"J'ai mang√© une pizza."},
  {inf:"travailler", aux:"avoir", pc:"j'ai travaill√©", de:"Ich habe gestern Abend gearbeitet.", fr:"J'ai travaill√© hier soir."},
];

// Personalpronomen f√ºr Modus 1
const pronouns = [
  {fr: "je", aux_etre: "suis", aux_avoir: "ai", de: "ich"},
  {fr: "tu", aux_etre: "es", aux_avoir: "as", de: "du"},
  {fr: "il", aux_etre: "est", aux_avoir: "a", de: "er"},
  {fr: "elle", aux_etre: "est", aux_avoir: "a", de: "sie"},
  {fr: "nous", aux_etre: "sommes", aux_avoir: "avons", de: "wir"},
  {fr: "vous", aux_etre: "√™tes", aux_avoir: "avez", de: "ihr/Sie"},
  {fr: "ils", aux_etre: "sont", aux_avoir: "ont", de: "sie (m)"},
  {fr: "elles", aux_etre: "sont", aux_avoir: "ont", de: "sie (f)"}
];

let current = {};
let currentMode = 1;
let isWaitingForCorrection = false;
let currentPronoun = null;

// Mode-Wechsel
document.querySelectorAll('.mode-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentMode = parseInt(btn.dataset.mode);
    
    if (currentMode === 1) {
      document.getElementById('mode1-inputs').classList.remove('hidden');
      document.getElementById('mode2-inputs').classList.add('hidden');
    } else {
      document.getElementById('mode1-inputs').classList.add('hidden');
      document.getElementById('mode2-inputs').classList.remove('hidden');
    }
    
    isWaitingForCorrection = false;
    newQuestion();
  });
});

function newQuestion() {
  current = verbs[Math.floor(Math.random() * verbs.length)];
  currentPronoun = pronouns[Math.floor(Math.random() * pronouns.length)];
  const questionDiv = document.getElementById('question');
  isWaitingForCorrection = false;
  
  if (currentMode === 1) {
    // Modus 1: Verb auf Franz√∂sisch mit zuf√§lliger Personalform
    questionDiv.innerHTML = `<strong>Infinitiv:</strong> ${current.inf}<br><small>Bilde das Pass√© Compos√© mit "<strong>${currentPronoun.fr}</strong>" (${currentPronoun.de})</small>`;
    document.getElementById('answer').value = "";
  } else {
    // Modus 2: Deutscher Satz (kompletter Satz!)
    questionDiv.innerHTML = `<strong>√úbersetze ins Franz√∂sische:</strong><br>"${current.de}"`;
    document.getElementById('sentence-answer').value = "";
  }
  
  document.getElementById('result').innerText = "";
  document.getElementById('feedback').classList.add('hidden');
  document.getElementById('feedback').innerHTML = "";
}

document.getElementById('check').addEventListener('click', () => {
  const res = document.getElementById('result');
  const feedback = document.getElementById('feedback');
  
  if (currentMode === 1) {
    // Modus 1: Verb-Modus - mit verschiedenen Pronomen
    const ans = document.getElementById('answer').value.trim().toLowerCase();
    
    if (!ans) {
      res.innerHTML = "<span id='wrong'>Bitte eine Antwort eingeben!</span>";
      feedback.classList.add('hidden');
      return;
    }
    
    // Erstelle die korrekte Antwort basierend auf Pronomen
    const auxVerb = current.aux === "√™tre" ? currentPronoun.aux_etre : currentPronoun.aux_avoir;
    const participle = current.pc.split(' ').pop(); // Partizip aus der je-Form extrahieren
    const correctAnswer = `${currentPronoun.fr} ${auxVerb} ${participle}`.toLowerCase();
    
    if (ans === correctAnswer) {
      res.innerHTML = "<span id='correct'>‚úÖ Richtig! Sehr gut!</span>";
      feedback.classList.add('hidden');
      isWaitingForCorrection = false;
      setTimeout(newQuestion, 2000);
    } else {
      // Detaillierte Fehleranalyse
      const correctParts = analyzeVerbAnswer(ans, current, currentPronoun, correctAnswer);
      
      res.innerHTML = "<span id='wrong'>‚ùå Noch nicht korrekt!</span>";
      feedback.classList.remove('hidden');
      feedback.innerHTML = `
        <strong>üéì Sprachlehrer-Feedback:</strong>
        ${correctParts.feedback}
        <br><br>
        <strong>Richtige L√∂sung:</strong> <b>${correctAnswer}</b><br>
        <small><i>Versuche es nochmal mit der richtigen Form, bevor du fortf√§hrst.</i></small>
      `;
      
      isWaitingForCorrection = true;
    }
  } else {
    // Modus 2: Satz-Modus - kompletter Satz
    const ans = document.getElementById('sentence-answer').value.trim().toLowerCase();
    
    if (!ans) {
      res.innerHTML = "<span id='wrong'>Bitte einen Satz eingeben!</span>";
      feedback.classList.add('hidden');
      return;
    }
    
    const correctAnswer = current.fr.toLowerCase().replace(/\.$/, '');
    const userAnswer = ans.replace(/\.$/, '');
    
    if (userAnswer === correctAnswer) {
      res.innerHTML = "<span id='correct'>‚úÖ Richtig! Perfekt √ºbersetzt!</span>";
      feedback.classList.add('hidden');
      isWaitingForCorrection = false;
      setTimeout(newQuestion, 2000);
    } else {
      // Detaillierte Fehleranalyse f√ºr S√§tze
      const sentenceFeedback = analyzeSentenceAnswer(userAnswer, current);
      
      res.innerHTML = "<span id='wrong'>‚ùå Noch nicht korrekt!</span>";
      feedback.classList.remove('hidden');
      feedback.innerHTML = `
        <strong>üéì Sprachlehrer-Feedback:</strong>
        ${sentenceFeedback}
        <br><br>
        <strong>Richtige L√∂sung:</strong> <b>${current.fr}</b><br>
        <small><i>Versuche es nochmal mit der richtigen √úbersetzung.</i></small>
      `;
      
      isWaitingForCorrection = true;
    }
  }
});

// Hilfsfunktion: Verb-Antwort analysieren
function analyzeVerbAnswer(userAnswer, verb, pronoun, correctAnswer) {
  const aux = verb.aux;
  const auxVerb = aux === "√™tre" ? pronoun.aux_etre : pronoun.aux_avoir;
  
  let feedback = '<ul>';
  
  // Check f√ºr Pronomen
  if (!userAnswer.startsWith(pronoun.fr.toLowerCase())) {
    feedback += `<li>‚ùå <strong>Pronomen fehlt oder falsch:</strong> Du solltest mit "${pronoun.fr}" beginnen</li>`;
  } else {
    feedback += `<li>‚úÖ Pronomen "${pronoun.fr}" ist korrekt</li>`;
  }
  
  // Check f√ºr Hilfsverb
  if (aux === "√™tre") {
    if (!userAnswer.includes(auxVerb)) {
      feedback += `<li>‚ùå <strong>Hilfsverb fehlt oder falsch:</strong> Dieses Verb ben√∂tigt "√™tre" ‚Üí "${pronoun.fr} ${auxVerb}"</li>`;
    } else {
      feedback += `<li>‚úÖ Hilfsverb "√™tre" (${auxVerb}) ist korrekt</li>`;
    }
  } else {
    if (!userAnswer.includes(auxVerb)) {
      feedback += `<li>‚ùå <strong>Hilfsverb fehlt oder falsch:</strong> Dieses Verb ben√∂tigt "avoir" ‚Üí "${pronoun.fr} ${auxVerb}"</li>`;
    } else {
      feedback += `<li>‚úÖ Hilfsverb "avoir" (${auxVerb}) ist korrekt</li>`;
    }
  }
  
  // Check f√ºr Partizip
  const participle = verb.pc.split(' ').pop(); // letztes Wort aus je-Form
  if (!userAnswer.includes(participle.replace(/\(e\)/, '').replace(/\(s\)/, ''))) {
    feedback += `<li>‚ùå <strong>Partizip fehlt oder falsch:</strong> Das Partizip von "${verb.inf}" ist "${participle}"</li>`;
  } else {
    feedback += '<li>‚úÖ Partizip ist korrekt</li>';
  }
  
  feedback += '</ul>';
  
  return { feedback };
}

// Hilfsfunktion: Satz-Antwort analysieren
function analyzeSentenceAnswer(userAnswer, verb) {
  const correct = verb.fr.toLowerCase().replace(/\.$/, '');
  const words = correct.split(' ');
  
  let feedback = '<ul>';
  let foundIssues = false;
  
  // Check f√ºr Pronomen
  if (!userAnswer.startsWith('j')) {
    feedback += '<li>‚ùå <strong>Pronomen fehlt:</strong> Der Satz sollte mit "je" oder "j\'" beginnen</li>';
    foundIssues = true;
  }
  
  // Check f√ºr Hilfsverb
  if (verb.aux === "√™tre" && !userAnswer.includes("suis")) {
    feedback += '<li>‚ùå <strong>Hilfsverb:</strong> Dieses Verb braucht "√™tre" ‚Üí "je suis"</li>';
    foundIssues = true;
  } else if (verb.aux === "avoir" && !userAnswer.includes("ai")) {
    feedback += '<li>‚ùå <strong>Hilfsverb:</strong> Dieses Verb braucht "avoir" ‚Üí "j\'ai"</li>';
    foundIssues = true;
  }
  
  // Check f√ºr wichtige W√∂rter
  const missingWords = words.filter(w => w.length > 2 && !userAnswer.includes(w));
  if (missingWords.length > 0) {
    feedback += `<li>‚ùå <strong>Fehlende W√∂rter:</strong> ${missingWords.join(', ')}</li>`;
    foundIssues = true;
  }
  
  if (!foundIssues) {
    feedback += '<li>‚ö†Ô∏è Die Struktur ist fast richtig, aber pr√ºfe nochmal Rechtschreibung und Grammatik</li>';
  }
  
  feedback += '</ul>';
  
  return feedback;
}

newQuestion();
</script>
</body>
</html>
